# Plan 1.0.1 구현 노트

- **날짜**: 2026-02-09
- **범위**: 코드 에디터(CodeMirror 6), 다크모드 그레이톤 테마, Ollama 가이드 문서

## 변경된 파일

### 수정
- `src/index.css` - .dark CSS 변수 뉴트럴 그레이로 교체, 스크롤바 색상 변경
- `src/components/layout/AppHeader.tsx` - 로고 그라데이션 from-primary/to-blue → neutral
- `src/components/snippet/SnippetDetail.tsx` - AI 바 bg-primary/* → bg-muted/bg-secondary
- `src/components/snippet/SnippetForm.tsx` - Code 필드 Textarea → CodeEditor 교체
- `src/components/snippet/SnippetForm.test.tsx` - CodeEditor mock 추가

### 신규
- `src/components/editor/CodeEditor.tsx` - CodeMirror 6 래퍼 컴포넌트
- `src/components/editor/CodeEditor.test.tsx` - 에디터 테스트 (3 tests)
- `.claude/docs/ollama-guide.md` - Ollama 연동 가이드 문서
- `.claude/docs/plan-1.0.1.md` - 플랜 문서

### 패키지 추가
- `codemirror`, `@codemirror/commands`, `@codemirror/view`, `@codemirror/state`
- `@codemirror/lang-javascript`, `@codemirror/lang-python`, `@codemirror/lang-rust`
- `@codemirror/lang-html`, `@codemirror/lang-css`, `@codemirror/lang-json`
- `@codemirror/theme-one-dark`

## 테스트 결과
- 77 frontend tests 통과 (기존 74 + CodeEditor 3)

## 구현 설명

### 왜 이렇게 구성했는가?
- **그레이톤 테마**: 블루 기반 다크모드는 코드 에디터의 syntax highlighting과 충돌 가능. 뉴트럴 그레이는 코드 색상이 돋보이게 함.
- **CodeMirror 6**: CM6은 모듈러 아키텍처로 필요한 기능만 선택적 로드 가능. Compartment 패턴으로 언어/테마를 런타임에 동적 교체.
- **useRef + Compartment**: React state와 CM6 내부 state 분리. onChangeRef로 stale closure 방지.

### 장점
- 진짜 코드 에디터 경험 (구문 강조, 줄 번호, 자동 들여쓰기, 괄호 매칭)
- 언어 선택 시 즉시 syntax highlighting 전환
- 다크/라이트 테마 자동 감지 및 전환
- 뉴트럴 그레이 팔레트로 코드 가독성 향상

### 단점 / 트레이드오프
- CM6 번들 사이즈 증가 (~200KB gzipped with all languages)
- jsdom에서 CM6 일부 기능 미지원 (getClientRects) → 테스트 시 mock 사용 필요
- 지원 언어가 6개로 제한 (JS/TS, Python, Rust, HTML, CSS, JSON)

### 대안
- Monaco Editor: VS Code 기반으로 더 풍부하지만 번들 사이즈가 훨씬 큼
- Prism.js + contenteditable: 가볍지만 에디터 기능 부족
